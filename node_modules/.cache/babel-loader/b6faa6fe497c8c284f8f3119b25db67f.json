{"ast":null,"code":"import _regeneratorRuntime from\"/home/seungju_oh@tmax.co.kr/seung/all-in-one/All-In-One-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _objectSpread from\"/home/seungju_oh@tmax.co.kr/seung/all-in-one/All-In-One-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _asyncToGenerator from\"/home/seungju_oh@tmax.co.kr/seung/all-in-one/All-In-One-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/seungju_oh@tmax.co.kr/seung/all-in-one/All-In-One-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{ListGroup,Container,Button,Form,Row,Col,ListGroupItem}from\"react-bootstrap\";import axios from\"axios\";import{useEffect,useState}from\"react\";import{useSelector}from\"react-redux\";import{Link}from\"react-router-dom\";import EmptyHeartImg from\"../assets/images/heart.png\";import HeartImg from\"../assets/images/heart_pressed.png\";import{CategoryDirection}from\"./CategoryBanner\";import{setMoney,setDate}from\"./Convenient\";import Rating from\"./Rating\";import Modal from\"./Modal\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function ProductDetail(_ref){var match=_ref.match,history=_ref.history;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),modalOpen=_useState2[0],setModalOpen=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),modalContents=_useState4[0],setModalContents=_useState4[1];var closeModal=function closeModal(){setModalOpen(false);};var _useState5=useState(1),_useState6=_slicedToArray(_useState5,2),amount=_useState6[0],setAmount=_useState6[1];var _useSelector=useSelector(function(state){return{isLoggedIn:state.user.isLoggedIn,userData:state.user.payload};}),isLoggedIn=_useSelector.isLoggedIn,userData=_useSelector.userData;var _useState7=useState({checked:false}),_useState8=_slicedToArray(_useState7,2),like=_useState8[0],setLike=_useState8[1];var _useState9=useState([]),_useState10=_slicedToArray(_useState9,2),images=_useState10[0],setImages=_useState10[1];var _useState11=useState({}),_useState12=_slicedToArray(_useState11,2),product=_useState12[0],setProduct=_useState12[1];var _useState13=useState({}),_useState14=_slicedToArray(_useState13,2),seller=_useState14[0],setSeller=_useState14[1];var fetchProduct=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var res,tmp,res_seller,body,res_likes;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios.get(\"/apis/v1/product/\"+match.params.number);case 2:res=_context.sent;tmp=res.data.payload;setProduct(_objectSpread(_objectSpread({},res.data.payload),{},{product_id:match.params.number}));setImages(tmp.image);_context.next=8;return axios.get(\"/apis/v1/user/\"+tmp.seller_id);case 8:res_seller=_context.sent;setSeller(res_seller.data.payload);// check likes\nif(!isLoggedIn){_context.next=16;break;}body={seller_id:res.data.payload.seller_id,buyer_id:userData.user_id,product_id:parseInt(match.params.number)};_context.next=14;return axios.post(\"/apis/v1/carts/check\",body);case 14:res_likes=_context.sent;setLike(res_likes.data.payload);case 16:case\"end\":return _context.stop();}}},_callee);}));return function fetchProduct(){return _ref2.apply(this,arguments);};}();useEffect(function(){fetchProduct();},[match.params.number,like.checked]);var onClickOrder=function onClickOrder(e){if(isLoggedIn===false||userData==null){setModalOpen(true);setModalContents(\"로그인 후 이용하세요.\");history.replace(\"/login\");}else if(userData.user_id==product.seller_id){setModalOpen(true);setModalContents(\"판매자가 구매할 수 없습니다.\");e.preventDefault();}else if(amount<1||amount>product.quantity){setModalOpen(true);setModalContents(\"수량이 올바르지 않습니다.\");e.preventDefault();}};var onClickCart=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var body;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!(isLoggedIn===false)){_context2.next=4;break;}setModalOpen(true);setModalContents(\"로그인 후 이용하세요.\");return _context2.abrupt(\"return\");case 4:if(!like.checked){_context2.next=10;break;}_context2.next=7;return axios.delete(\"/apis/v1/carts/\".concat(like[0]._id));case 7:setLike({checked:false});_context2.next=14;break;case 10:body={seller_id:product.seller_id,buyer_id:userData.user_id,product_id:parseInt(product.product_id)};_context2.next=13;return axios.post(\"/apis/v1/carts/\",body);case 13:setLike({checked:true});case 14:case\"end\":return _context2.stop();}}},_callee2);}));return function onClickCart(){return _ref3.apply(this,arguments);};}();var onChangeHandler=function onChangeHandler(e){var value=e.target.value;setAmount(parseInt(value));};var displayImages=function displayImages(){if(images.length==1){return;}return images.slice(1).map(function(img){return/*#__PURE__*/_jsxs(ListGroupItem,{children:[/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"img\",{style:{width:\"60vw\"},src:img}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"br\",{})]});});};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Modal,{open:modalOpen,close:closeModal,children:modalContents}),/*#__PURE__*/_jsxs(Container,{children:[/*#__PURE__*/_jsx(CategoryDirection,{tag1:product.category,tag2:product.name}),/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{xs:\"12\",sm:\"12\",lg:\"7\",children:/*#__PURE__*/_jsx(\"img\",{style:{width:\"90%\",height:\"auto\"},src:images[0]})}),/*#__PURE__*/_jsxs(Col,{xs:\"12\",sm:\"10\",lg:\"5\",children:[/*#__PURE__*/_jsx(Row,{style:{paddingTop:5},children:/*#__PURE__*/_jsx(Rating,{user:seller,area:product.area})}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsxs(Row,{style:{marginTop:20,paddingTop:20},children:[/*#__PURE__*/_jsx(Col,{xs:\"9\",sm:\"9\",children:/*#__PURE__*/_jsx(\"p\",{style:{marginLeft:20,fontSize:\"2.2rem\",fontWeight:\"bolder\"},children:product.name})}),/*#__PURE__*/_jsx(Col,{xs:\"3\",sm:\"3\",children:/*#__PURE__*/_jsx(\"img\",{style:{width:\"2rem\"},src:like.checked?HeartImg:EmptyHeartImg,onClick:onClickCart})})]}),/*#__PURE__*/_jsxs(\"p\",{style:{fontSize:\"2rem\",margin:20},children:[setMoney(product.price),\" \\u20A9\"]}),/*#__PURE__*/_jsxs(\"p\",{style:{fontSize:\"1.5rem\",margin:20},children:[\"\\uB0A8\\uC740 \\uC218\\uB7C9: \",product.quantity]}),/*#__PURE__*/_jsxs(Row,{style:{fontSize:\"1.5rem\",padding:20},children:[/*#__PURE__*/_jsx(Col,{xs:\"6\",sm:\"12\",lg:4,children:/*#__PURE__*/_jsx(\"p\",{children:\"\\uC120\\uD0DD \\uC218\\uB7C9:\"})}),/*#__PURE__*/_jsx(Col,{xs:\"6\",sm:\"9\",lg:4,children:/*#__PURE__*/_jsx(Form,{children:/*#__PURE__*/_jsx(Form.Group,{controlId:\"exampleForm.ControlInput1\",children:/*#__PURE__*/_jsx(Form.Control,{style:{fontSize:\"1.5rem\"},type:\"number\",onChange:onChangeHandler,value:amount})})})})]}),/*#__PURE__*/_jsx(Col,{children:/*#__PURE__*/_jsxs(\"p\",{style:{fontSize:\"3em\",margin:20},children:[product.price?(product.price*amount).toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g,\",\"):product.price*amount,\" \",\"\\u20A9\"]})}),/*#__PURE__*/_jsx(Col,{xs:\"12\",children:/*#__PURE__*/_jsx(Link,{to:isLoggedIn?{pathname:\"/purchase\",state:{product:product,demand_amount:amount}}:\"/product/\"+match.params.number,style:{textDecoration:\"none\"},children:/*#__PURE__*/_jsx(\"div\",{className:\"d-grid gap-2\",children:/*#__PURE__*/_jsx(\"button\",{className:\"emptyButton\",onClick:onClickOrder,style:{fontSize:\"1.3rem\",margin:20,height:50},children:\"\\uAD6C\\uB9E4\\uD558\\uAE30\"})})})})]})]}),/*#__PURE__*/_jsx(Row,{style:{marginTop:80},children:/*#__PURE__*/_jsx(Col,{children:/*#__PURE__*/_jsxs(ListGroup,{children:[/*#__PURE__*/_jsx(ListGroupItem,{children:/*#__PURE__*/_jsxs(\"p\",{style:{margin:10,fontSize:\"2rem\"},children:[\"\\uC0C1\\uD488 \\uC0C1\\uC138\",\" \"]})}),displayImages(),/*#__PURE__*/_jsx(ListGroupItem,{children:/*#__PURE__*/_jsx(\"p\",{style:{margin:20,fontSize:\"2rem\"},children:product.description})})]})})})]})]});}export default ProductDetail;","map":{"version":3,"sources":["/home/seungju_oh@tmax.co.kr/seung/all-in-one/All-In-One-front/src/components/ProductDetail.js"],"names":["ListGroup","Container","Button","Form","Row","Col","ListGroupItem","axios","useEffect","useState","useSelector","Link","EmptyHeartImg","HeartImg","CategoryDirection","setMoney","setDate","Rating","Modal","ProductDetail","match","history","modalOpen","setModalOpen","modalContents","setModalContents","closeModal","amount","setAmount","state","isLoggedIn","user","userData","payload","checked","like","setLike","images","setImages","product","setProduct","seller","setSeller","fetchProduct","get","params","number","res","tmp","data","product_id","image","seller_id","res_seller","body","buyer_id","user_id","parseInt","post","res_likes","onClickOrder","e","replace","preventDefault","quantity","onClickCart","delete","_id","onChangeHandler","value","target","displayImages","length","slice","map","img","width","category","name","height","paddingTop","area","marginTop","marginLeft","fontSize","fontWeight","margin","price","padding","toString","pathname","demand_amount","textDecoration","description"],"mappings":"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","sourcesContent":["import {\n    ListGroup,\n    Container,\n    Button,\n    Form,\n    Row,\n    Col,\n    ListGroupItem,\n} from \"react-bootstrap\";\nimport axios from \"axios\";\nimport { useEffect, useState } from \"react\";\nimport { useSelector } from \"react-redux\";\nimport { Link } from \"react-router-dom\";\nimport EmptyHeartImg from \"../assets/images/heart.png\";\nimport HeartImg from \"../assets/images/heart_pressed.png\";\nimport { CategoryDirection } from \"./CategoryBanner\";\nimport { setMoney, setDate } from \"./Convenient\";\nimport Rating from \"./Rating\";\nimport Modal from \"./Modal\";\n\nfunction ProductDetail({ match, history }) {\n    const [modalOpen, setModalOpen] = useState(false);\n    const [modalContents, setModalContents] = useState(\"\");\n    const closeModal = () => {\n        setModalOpen(false);\n    };\n\n    const [amount, setAmount] = useState(1);\n    const { isLoggedIn, userData } = useSelector((state) => ({\n        isLoggedIn: state.user.isLoggedIn,\n        userData: state.user.payload,\n    }));\n    const [like, setLike] = useState({ checked: false });\n    const [images, setImages] = useState([]);\n    const [product, setProduct] = useState({});\n    const [seller, setSeller] = useState({});\n\n    const fetchProduct = async () => {\n        let res = await axios.get(\"/apis/v1/product/\" + match.params.number);\n        let tmp = res.data.payload;\n        setProduct({\n            ...res.data.payload,\n            product_id: match.params.number,\n        });\n        setImages(tmp.image);\n\n        let res_seller = await axios.get(\"/apis/v1/user/\" + tmp.seller_id);\n        setSeller(res_seller.data.payload);\n\n        // check likes\n\n        if (isLoggedIn) {\n            let body = {\n                seller_id: res.data.payload.seller_id,\n                buyer_id: userData.user_id,\n                product_id: parseInt(match.params.number),\n            };\n            let res_likes = await axios.post(\"/apis/v1/carts/check\", body);\n            setLike(res_likes.data.payload);\n        }\n    };\n\n    useEffect(() => {\n        fetchProduct();\n    }, [match.params.number, like.checked]);\n\n    const onClickOrder = (e) => {\n        if (isLoggedIn === false || userData == null) {\n            setModalOpen(true);\n            setModalContents(\"로그인 후 이용하세요.\");\n            history.replace(\"/login\");\n        } else if (userData.user_id == product.seller_id) {\n            setModalOpen(true);\n            setModalContents(\"판매자가 구매할 수 없습니다.\");\n            e.preventDefault();\n        } else if (amount < 1 || amount > product.quantity) {\n            setModalOpen(true);\n            setModalContents(\"수량이 올바르지 않습니다.\");\n            e.preventDefault();\n        }\n    };\n\n    const onClickCart = async () => {\n        if (isLoggedIn === false) {\n            setModalOpen(true);\n            setModalContents(\"로그인 후 이용하세요.\");\n            return;\n        }\n\n        if (like.checked) {\n            await axios.delete(`/apis/v1/carts/${like[0]._id}`);\n            setLike({ checked: false });\n        } else {\n            let body = {\n                seller_id: product.seller_id,\n                buyer_id: userData.user_id,\n                product_id: parseInt(product.product_id),\n            };\n            await axios.post(\"/apis/v1/carts/\", body);\n            setLike({ checked: true });\n        }\n    };\n\n    const onChangeHandler = (e) => {\n        const { value } = e.target;\n        setAmount(parseInt(value));\n    };\n\n    const displayImages = () => {\n        if (images.length == 1) {\n            return;\n        }\n        return images.slice(1).map((img) => (\n            <ListGroupItem>\n                <br />\n                <img\n                    style={{\n                        width: \"60vw\",\n                    }}\n                    src={img}\n                ></img>\n                <br />\n                <br />\n            </ListGroupItem>\n        ));\n    };\n\n    return (\n        <div>\n            <Modal open={modalOpen} close={closeModal}>\n                {modalContents}\n            </Modal>\n            <Container>\n                <CategoryDirection\n                    tag1={product.category}\n                    tag2={product.name}\n                />\n                <Row>\n                    <Col xs=\"12\" sm=\"12\" lg=\"7\">\n                        <img\n                            style={{\n                                width: \"90%\",\n                                height: \"auto\",\n                            }}\n                            src={images[0]}\n                        ></img>\n                    </Col>\n                    <Col xs=\"12\" sm=\"10\" lg=\"5\">\n                        <Row style={{ paddingTop: 5 }}>\n                            <Rating user={seller} area={product.area} />\n                        </Row>\n                        <hr />\n\n                        <Row style={{ marginTop: 20, paddingTop: 20 }}>\n                            <Col xs=\"9\" sm=\"9\">\n                                <p\n                                    style={{\n                                        marginLeft: 20,\n                                        fontSize: \"2.2rem\",\n                                        fontWeight: \"bolder\",\n                                    }}\n                                >\n                                    {product.name}\n                                </p>\n                            </Col>\n                            <Col xs=\"3\" sm=\"3\">\n                                <img\n                                    style={{ width: \"2rem\" }}\n                                    src={\n                                        like.checked ? HeartImg : EmptyHeartImg\n                                    }\n                                    onClick={onClickCart}\n                                ></img>\n                            </Col>\n                        </Row>\n\n                        <p style={{ fontSize: \"2rem\", margin: 20 }}>\n                            {setMoney(product.price)} ₩\n                        </p>\n                        <p style={{ fontSize: \"1.5rem\", margin: 20 }}>\n                            남은 수량: {product.quantity}\n                        </p>\n                        <Row style={{ fontSize: \"1.5rem\", padding: 20 }}>\n                            <Col xs=\"6\" sm=\"12\" lg={4}>\n                                <p>선택 수량:</p>\n                            </Col>\n\n                            <Col xs=\"6\" sm=\"9\" lg={4}>\n                                <Form>\n                                    <Form.Group controlId=\"exampleForm.ControlInput1\">\n                                        <Form.Control\n                                            style={{ fontSize: \"1.5rem\" }}\n                                            type=\"number\"\n                                            onChange={onChangeHandler}\n                                            value={amount}\n                                        />\n                                    </Form.Group>\n                                </Form>\n                            </Col>\n                        </Row>\n                        <Col>\n                            <p style={{ fontSize: \"3em\", margin: 20 }}>\n                                {product.price\n                                    ? (product.price * amount)\n                                          .toString()\n                                          .replace(/\\B(?=(\\d{3})+(?!\\d))/g, \",\")\n                                    : product.price * amount}{\" \"}\n                                ₩\n                            </p>\n                        </Col>\n\n                        <Col xs=\"12\">\n                            <Link\n                                to={\n                                    isLoggedIn\n                                        ? {\n                                              pathname: `/purchase`,\n                                              state: {\n                                                  product: product,\n                                                  demand_amount: amount,\n                                              },\n                                          }\n                                        : \"/product/\" + match.params.number\n                                }\n                                style={{ textDecoration: \"none\" }}\n                            >\n                                <div className=\"d-grid gap-2\">\n                                    <button\n                                        className=\"emptyButton\"\n                                        onClick={onClickOrder}\n                                        style={{\n                                            fontSize: \"1.3rem\",\n                                            margin: 20,\n                                            height: 50,\n                                        }}\n                                    >\n                                        구매하기\n                                    </button>\n                                </div>\n                            </Link>\n                        </Col>\n                    </Col>\n                </Row>\n\n                <Row style={{ marginTop: 80 }}>\n                    <Col>\n                        <ListGroup>\n                            <ListGroupItem>\n                                <p style={{ margin: 10, fontSize: \"2rem\" }}>\n                                    상품 상세{\" \"}\n                                </p>\n                            </ListGroupItem>\n\n                            {displayImages()}\n\n                            <ListGroupItem>\n                                <p style={{ margin: 20, fontSize: \"2rem\" }}>\n                                    {product.description}\n                                </p>\n                            </ListGroupItem>\n                        </ListGroup>\n                    </Col>\n                </Row>\n            </Container>\n        </div>\n    );\n}\n\nexport default ProductDetail;\n"]},"metadata":{},"sourceType":"module"}