{"ast":null,"code":"import _regeneratorRuntime from\"/home/seungju_oh@tmax.co.kr/seung/all-in-one/All-In-One-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _objectSpread from\"/home/seungju_oh@tmax.co.kr/seung/all-in-one/All-In-One-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _asyncToGenerator from\"/home/seungju_oh@tmax.co.kr/seung/all-in-one/All-In-One-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/seungju_oh@tmax.co.kr/seung/all-in-one/All-In-One-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect,useMemo}from\"react\";import axios from\"axios\";import{ListGroup,Container,Row,Col,Card}from\"react-bootstrap\";import Accordion from\"react-bootstrap/Accordion\";import{useSelector}from\"react-redux\";import arrow from\"../assets/images/arrow.png\";import EmptyBox from\"../assets/images/box.png\";import{CategoryDirection}from\"./CategoryBanner\";import{setMoney,setDate}from\"./Convenient\";import Rating from\"./Rating\";import Modal from\"./Modal\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function MySalesDetail(_ref){var history=_ref.history,match=_ref.match;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),modalOpen=_useState2[0],setModalOpen=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),modalContents=_useState4[0],setModalContents=_useState4[1];var closeModal=function closeModal(){setModalOpen(false);};var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),btnValue=_useState6[0],setBtnValue=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),orders=_useState8[0],setOrders=_useState8[1];var _useState9=useState([]),_useState10=_slicedToArray(_useState9,2),images=_useState10[0],setImages=_useState10[1];var _useState11=useState({}),_useState12=_slicedToArray(_useState11,2),product=_useState12[0],setProduct=_useState12[1];var _useSelector=useSelector(function(state){return{isLoggedIn:state.user.isLoggedIn,userData:state.user.payload};}),isLoggedIn=_useSelector.isLoggedIn,userData=_useSelector.userData;var fetchProduct=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var res,image_list;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios.get(\"/apis/v1/product/\"+match.params.number);case 2:res=_context.sent;setProduct(_objectSpread(_objectSpread({},res.data.payload),{},{product_id:match.params.number}));_context.next=6;return res.data.payload.image.map(function(img){return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"img\",{style:{maxWidth:\"100%\",height:\"auto\"},src:img}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"br\",{})]});});case 6:image_list=_context.sent;setImages(image_list);case 8:case\"end\":return _context.stop();}}},_callee);}));return function fetchProduct(){return _ref2.apply(this,arguments);};}();var fetchUserInfo=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(userId){var res,data;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return axios.get(\"/apis/v1/user/\"+userId);case 2:res=_context2.sent;setModalOpen(true);data=res.data.payload;setModalContents(/*#__PURE__*/_jsxs(Container,{children:[/*#__PURE__*/_jsx(Rating,{user:data}),/*#__PURE__*/_jsx(Row,{style:{marginTop:20},children:/*#__PURE__*/_jsxs(Col,{children:[\"\\uC774\\uBA54\\uC77C: \",data.useremail]})}),/*#__PURE__*/_jsx(Row,{style:{marginTop:20},children:/*#__PURE__*/_jsxs(Col,{children:[\"\\uACC4\\uC815 \\uC0DD\\uC131\\uC77C: \",setDate(data.created_at)]})})]}));case 6:case\"end\":return _context2.stop();}}},_callee2);}));return function fetchUserInfo(_x){return _ref3.apply(this,arguments);};}();var fetchOrders=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var res,tmp_orders,orderlist;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return axios.get(\"/apis/v1/order/sale/\"+match.params.number);case 2:res=_context3.sent;tmp_orders=res.data.payload.filter(function(order){return order.sales_stage!=\"SO\";});console.log(tmp_orders);orderlist=tmp_orders.map(function(order,index){var sale_status=\"\";if(order.sales_stage==\"S\")sale_status=\"판매 중\";else if(order.sales_stage==\"SR\")sale_status=\"예약 중\";else sale_status=\"판매 완료\";return/*#__PURE__*/_jsx(ListGroup.Item,{children:/*#__PURE__*/_jsxs(Row,{style:{margin:20},children:[/*#__PURE__*/_jsxs(Col,{children:[/*#__PURE__*/_jsxs(\"p\",{style:{fontSize:\"1.5rem\"},children:[\"\\uC8FC\\uBB38\\uC790 \\uC120\\uD638 \\uC7A5\\uC18C: \",order.address]}),/*#__PURE__*/_jsxs(\"p\",{style:{fontSize:\"1.5rem\"},children:[\"\\uC5F0\\uB77D\\uCC98: \",order.phone_number]}),/*#__PURE__*/_jsxs(\"p\",{style:{fontSize:\"1.5rem\"},children:[\"\\uC8FC\\uBB38\\uB7C9: \",order.demand_quantity]}),/*#__PURE__*/_jsxs(\"p\",{style:{fontSize:\"1.5rem\"},children:[\"\\uAC00\\uACA9: \",setMoney(order.price),\" \\uC6D0\"]}),/*#__PURE__*/_jsxs(\"p\",{style:{fontSize:\"1.5rem\"},children:[\"\\uC8FC\\uBB38 \\uC77C\\uC9DC: \",setDate(order.created_at)]})]}),/*#__PURE__*/_jsx(Col,{children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsx(Col,{children:/*#__PURE__*/_jsx(\"button\",{className:\"emptyButton\",onClick:function onClick(){return fetchUserInfo(order.buyer_id);},style:{height:\"4rem\",fontSize:\"1.3rem\"},children:\"\\uC8FC\\uBB38\\uC790 \\uC815\\uBCF4 \\uBCF4\\uAE30\"})})}),/*#__PURE__*/_jsxs(Row,{style:{marginTop:20},children:[/*#__PURE__*/_jsx(Col,{lg:\"3\",sm:\"4\",xs:\"12\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"dropdown\",children:[/*#__PURE__*/_jsx(\"button\",{style:{height:\"4rem\",padding:10,width:100},className:\"dropdown-button \",children:btnValue?btnValue:sale_status}),/*#__PURE__*/_jsxs(\"div\",{class:\"dropdown-content\",children:[/*#__PURE__*/_jsx(\"a\",{name:\"\\uC608\\uC57D \\uC911\",onClick:function onClick(e){onClickHandler({order:order,product_id:match.params.number},e);},children:\"\\uC608\\uC57D \\uC911\"}),/*#__PURE__*/_jsx(\"a\",{name:\"\\uD310\\uB9E4 \\uC644\\uB8CC\",onClick:function onClick(e){onClickHandler({order:order,product_id:match.params.number},e);},children:\"\\uD310\\uB9E4 \\uC644\\uB8CC\"}),/*#__PURE__*/_jsx(\"a\",{name:\"\\uAC70\\uB798 \\uCDE8\\uC18C\",onClick:function onClick(e){onClickHandler({order:order,product_id:match.params.number},e);},children:\"\\uAC70\\uB798 \\uCDE8\\uC18C\"})]})]})}),/*#__PURE__*/_jsx(Col,{lg:\"6\",sm:\"12\",xs:\"12\",children:/*#__PURE__*/_jsx(\"p\",{style:{fontSize:\"1.2rem\",padding:10,color:\"red\"},children:\"\\uC8FC\\uBB38 \\uC0C1\\uD0DC\\uB97C \\uC870\\uD68C\\uD574\\uC8FC\\uC138\\uC694!\"})})]})]})})]})},index);});setOrders(orderlist);case 7:case\"end\":return _context3.stop();}}},_callee3);}));return function fetchOrders(){return _ref4.apply(this,arguments);};}();useEffect(function(){fetchProduct();fetchOrders();},[userData.user_id,btnValue]);var onClickHandler=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(orderData,e){var product_id,order,data,_data;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:product_id=orderData.product_id,order=orderData.order;if(e.target.name===\"판매 완료\"){data={sales_stage:\"SO\",product_id:product_id,demand_quantity:order.demand_quantity,total_quantity:order.total_quantity};axios.post(\"/apis/v1/order/\"+order.order_id,data).then(function(res){setModalOpen(true);setModalContents(\"거래가 완료되었습니다\");}).catch(function(e){setModalOpen(true);setModalContents(\"Error: 관리자에게 문의하세요\");});}else if(e.target.name===\"예약 중\"){_data={sales_stage:\"SR\"};axios.post(\"/apis/v1/order/\"+order.order_id,_data).then(function(res){setModalOpen(true);setModalContents(\"거래가 예약되었습니다\");}).catch(function(e){setModalOpen(true);setModalContents(\"Error: 관리자에게 문의하세요\");});}else{axios.delete(\"/apis/v1/order/\"+order.order_id).then(function(res){setModalOpen(true);setModalContents(\"주문이 취소되었습니다.\");}).catch(function(e){setModalOpen(true);setModalContents(\"Error: 관리자에게 문의하세요\");});}setBtnValue(e.target.name);case 3:case\"end\":return _context4.stop();}}},_callee4);}));return function onClickHandler(_x2,_x3){return _ref5.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Modal,{open:modalOpen,close:closeModal,children:modalContents}),/*#__PURE__*/_jsxs(Container,{children:[/*#__PURE__*/_jsx(CategoryDirection,{tag1:\"내 상품 목록\",tag2:product.name}),/*#__PURE__*/_jsx(Accordion,{style:{marginTop:100},children:/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsx(Accordion.Toggle,{as:Card.Header,eventKey:\"0\",children:/*#__PURE__*/_jsx(\"p\",{style:{fontSize:\"1.7rem\",margin:15},children:\"\\uB0B4 \\uC0C1\\uD488 \\uD655\\uC778\\uD558\\uAE30\"})}),/*#__PURE__*/_jsx(Accordion.Collapse,{eventKey:\"0\",children:/*#__PURE__*/_jsx(Card.Body,{children:/*#__PURE__*/_jsx(Row,{className:\"justify-content-md-center\",children:/*#__PURE__*/_jsxs(Col,{children:[/*#__PURE__*/_jsxs(ListGroup,{children:[/*#__PURE__*/_jsxs(ListGroup.Item,{style:{fontSize:\"1.3rem\"},children:[\"\\uCE74\\uD14C\\uACE0\\uB9AC: \",product.category]}),/*#__PURE__*/_jsxs(ListGroup.Item,{style:{fontSize:\"1.3rem\"},children:[\"\\uC0C1\\uD488\\uBA85: \",product.name]}),/*#__PURE__*/_jsxs(ListGroup.Item,{style:{fontSize:\"1.3rem\"},children:[\"\\uAC00\\uACA9: \",setMoney(product.price),\" \",\"\\uC6D0\"]}),/*#__PURE__*/_jsxs(ListGroup.Item,{style:{fontSize:\"1.3rem\"},children:[\"\\uC218\\uB7C9: \",product.quantity]}),/*#__PURE__*/_jsxs(ListGroup.Item,{style:{fontSize:\"1.3rem\"},children:[\"\\uC124\\uBA85: \",product.description]}),/*#__PURE__*/_jsxs(ListGroup.Item,{style:{fontSize:\"1.3rem\"},children:[\"\\uB4F1\\uB85D\\uC77C:\",\" \",setDate(product.created_at)]}),/*#__PURE__*/_jsx(ListGroup.Item,{children:images})]}),/*#__PURE__*/_jsx(\"br\",{})]})})})})]})}),/*#__PURE__*/_jsx(ListGroup,{style:{marginTop:20},children:orders.length==0?/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"p\",{style:{fontSize:\"1.7rem\"},children:\"\\uC544\\uC9C1 \\uC8FC\\uBB38\\uD55C \\uC0AC\\uB78C\\uC774 \\uC5C6\\uB124\\uC694...\"}),/*#__PURE__*/_jsx(\"img\",{style:{maxWidth:\"50%\",height:\"auto\"},src:EmptyBox})]}):/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"p\",{className:\"primaryColor\",style:{fontSize:\"1.8rem\",margin:20},children:\"\\uC8FC\\uBB38 \\uC694\\uCCAD\\uC774 \\uB4E4\\uC5B4\\uC654\\uC5B4\\uC694!\"}),orders]})})]})]});}export default MySalesDetail;","map":{"version":3,"sources":["/home/seungju_oh@tmax.co.kr/seung/all-in-one/All-In-One-front/src/components/MySalesDetail.js"],"names":["React","useState","useEffect","useMemo","axios","ListGroup","Container","Row","Col","Card","Accordion","useSelector","arrow","EmptyBox","CategoryDirection","setMoney","setDate","Rating","Modal","MySalesDetail","history","match","modalOpen","setModalOpen","modalContents","setModalContents","closeModal","btnValue","setBtnValue","orders","setOrders","images","setImages","product","setProduct","state","isLoggedIn","user","userData","payload","fetchProduct","get","params","number","res","data","product_id","image","map","img","maxWidth","height","image_list","fetchUserInfo","userId","marginTop","useremail","created_at","fetchOrders","tmp_orders","filter","order","sales_stage","console","log","orderlist","index","sale_status","margin","fontSize","address","phone_number","demand_quantity","price","buyer_id","padding","width","e","onClickHandler","color","user_id","orderData","target","name","total_quantity","post","order_id","then","catch","delete","Header","category","quantity","description","length"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useMemo } from \"react\";\nimport axios from \"axios\";\nimport { ListGroup, Container, Row, Col, Card } from \"react-bootstrap\";\nimport Accordion from \"react-bootstrap/Accordion\";\nimport { useSelector } from \"react-redux\";\nimport arrow from \"../assets/images/arrow.png\";\nimport EmptyBox from \"../assets/images/box.png\";\nimport { CategoryDirection } from \"./CategoryBanner\";\nimport { setMoney, setDate } from \"./Convenient\";\nimport Rating from \"./Rating\";\nimport Modal from \"./Modal\";\n\nfunction MySalesDetail({ history, match }) {\n    const [modalOpen, setModalOpen] = useState(false);\n    const [modalContents, setModalContents] = useState(\"\");\n    const closeModal = () => {\n        setModalOpen(false);\n    };\n    const [btnValue, setBtnValue] = useState(\"\");\n    const [orders, setOrders] = useState([]);\n    const [images, setImages] = useState([]);\n    const [product, setProduct] = useState({});\n    const { isLoggedIn, userData } = useSelector((state) => ({\n        isLoggedIn: state.user.isLoggedIn,\n        userData: state.user.payload,\n    }));\n\n    const fetchProduct = async () => {\n        let res = await axios.get(\"/apis/v1/product/\" + match.params.number);\n\n        setProduct({\n            ...res.data.payload,\n            product_id: match.params.number,\n        });\n        let image_list = await res.data.payload.image.map((img) => (\n            <div>\n                <br />\n                <img\n                    style={{\n                        maxWidth: \"100%\",\n                        height: \"auto\",\n                    }}\n                    src={img}\n                ></img>\n                <br />\n                <br />\n            </div>\n        ));\n        setImages(image_list);\n    };\n\n    const fetchUserInfo = async (userId) => {\n        let res = await axios.get(\"/apis/v1/user/\" + userId);\n        setModalOpen(true);\n        let data = res.data.payload;\n        setModalContents(\n            <Container>\n                <Rating user={data}></Rating>\n                <Row style={{ marginTop: 20 }}>\n                    <Col>이메일: {data.useremail}</Col>\n                </Row>\n                <Row style={{ marginTop: 20 }}>\n                    <Col>계정 생성일: {setDate(data.created_at)}</Col>\n                </Row>\n            </Container>\n        );\n    };\n\n    const fetchOrders = async () => {\n        let res = await axios.get(\"/apis/v1/order/sale/\" + match.params.number);\n        let tmp_orders = res.data.payload.filter(\n            (order) => order.sales_stage != \"SO\"\n        );\n\n        console.log(tmp_orders);\n        let orderlist = tmp_orders.map((order, index) => {\n            let sale_status = \"\";\n            if (order.sales_stage == \"S\") sale_status = \"판매 중\";\n            else if (order.sales_stage == \"SR\") sale_status = \"예약 중\";\n            else sale_status = \"판매 완료\";\n\n            return (\n                <ListGroup.Item key={index}>\n                    <Row style={{ margin: 20 }}>\n                        <Col>\n                            <p style={{ fontSize: \"1.5rem\" }}>\n                                주문자 선호 장소: {order.address}\n                            </p>\n                            <p style={{ fontSize: \"1.5rem\" }}>\n                                연락처: {order.phone_number}\n                            </p>\n                            <p style={{ fontSize: \"1.5rem\" }}>\n                                주문량: {order.demand_quantity}\n                            </p>\n                            <p style={{ fontSize: \"1.5rem\" }}>\n                                가격: {setMoney(order.price)} 원\n                            </p>\n                            <p style={{ fontSize: \"1.5rem\" }}>\n                                주문 일짜: {setDate(order.created_at)}\n                            </p>\n                        </Col>\n                        <Col>\n                            <Row>\n                                <Row>\n                                    <Col>\n                                        <button\n                                            className=\"emptyButton\"\n                                            onClick={() =>\n                                                fetchUserInfo(order.buyer_id)\n                                            }\n                                            style={{\n                                                height: \"4rem\",\n                                                fontSize: \"1.3rem\",\n                                            }}\n                                        >\n                                            주문자 정보 보기\n                                        </button>\n                                    </Col>\n                                </Row>\n                                <Row style={{ marginTop: 20 }}>\n                                    <Col lg=\"3\" sm=\"4\" xs=\"12\">\n                                        <div className=\"dropdown\">\n                                            <button\n                                                style={{\n                                                    height: \"4rem\",\n                                                    padding: 10,\n                                                    width: 100,\n                                                }}\n                                                className=\"dropdown-button \"\n                                            >\n                                                {btnValue\n                                                    ? btnValue\n                                                    : sale_status}\n                                            </button>\n                                            <div class=\"dropdown-content\">\n                                                <a\n                                                    name=\"예약 중\"\n                                                    onClick={(e) => {\n                                                        onClickHandler(\n                                                            {\n                                                                order,\n                                                                product_id:\n                                                                    match.params\n                                                                        .number,\n                                                            },\n                                                            e\n                                                        );\n                                                    }}\n                                                >\n                                                    예약 중\n                                                </a>\n                                                <a\n                                                    name=\"판매 완료\"\n                                                    onClick={(e) => {\n                                                        onClickHandler(\n                                                            {\n                                                                order,\n                                                                product_id:\n                                                                    match.params\n                                                                        .number,\n                                                            },\n                                                            e\n                                                        );\n                                                    }}\n                                                >\n                                                    판매 완료\n                                                </a>\n                                                <a\n                                                    name=\"거래 취소\"\n                                                    onClick={(e) => {\n                                                        onClickHandler(\n                                                            {\n                                                                order,\n                                                                product_id:\n                                                                    match.params\n                                                                        .number,\n                                                            },\n                                                            e\n                                                        );\n                                                    }}\n                                                >\n                                                    거래 취소\n                                                </a>\n                                            </div>\n                                        </div>\n                                    </Col>\n                                    <Col lg=\"6\" sm=\"12\" xs=\"12\">\n                                        <p\n                                            style={{\n                                                fontSize: \"1.2rem\",\n                                                padding: 10,\n                                                color: \"red\",\n                                            }}\n                                        >\n                                            주문 상태를 조회해주세요!\n                                        </p>\n                                    </Col>\n                                </Row>\n                            </Row>\n                        </Col>\n                    </Row>\n                </ListGroup.Item>\n            );\n        });\n        setOrders(orderlist);\n    };\n\n    useEffect(() => {\n        fetchProduct();\n        fetchOrders();\n    }, [userData.user_id, btnValue]);\n\n    const onClickHandler = async (orderData, e) => {\n        const { product_id, order } = orderData;\n\n        if (e.target.name === \"판매 완료\") {\n            let data = {\n                sales_stage: \"SO\",\n                product_id,\n                demand_quantity: order.demand_quantity,\n                total_quantity: order.total_quantity,\n            };\n\n            axios\n                .post(\"/apis/v1/order/\" + order.order_id, data)\n                .then((res) => {\n                    setModalOpen(true);\n                    setModalContents(\"거래가 완료되었습니다\");\n                })\n                .catch((e) => {\n                    setModalOpen(true);\n                    setModalContents(\"Error: 관리자에게 문의하세요\");\n                });\n        } else if (e.target.name === \"예약 중\") {\n            let data = { sales_stage: \"SR\" };\n            axios\n                .post(\"/apis/v1/order/\" + order.order_id, data)\n                .then((res) => {\n                    setModalOpen(true);\n                    setModalContents(\"거래가 예약되었습니다\");\n                })\n                .catch((e) => {\n                    setModalOpen(true);\n                    setModalContents(\"Error: 관리자에게 문의하세요\");\n                });\n        } else {\n            axios\n                .delete(\"/apis/v1/order/\" + order.order_id)\n                .then((res) => {\n                    setModalOpen(true);\n                    setModalContents(\"주문이 취소되었습니다.\");\n                })\n                .catch((e) => {\n                    setModalOpen(true);\n                    setModalContents(\"Error: 관리자에게 문의하세요\");\n                });\n        }\n        setBtnValue(e.target.name);\n    };\n\n    return (\n        <div>\n            <Modal open={modalOpen} close={closeModal}>\n                {modalContents}\n            </Modal>\n            <Container>\n                <CategoryDirection\n                    tag1={\"내 상품 목록\"}\n                    tag2={product.name}\n                ></CategoryDirection>\n\n                <Accordion style={{ marginTop: 100 }}>\n                    <Card>\n                        <Accordion.Toggle as={Card.Header} eventKey=\"0\">\n                            <p style={{ fontSize: \"1.7rem\", margin: 15 }}>\n                                내 상품 확인하기\n                            </p>\n                        </Accordion.Toggle>\n\n                        <Accordion.Collapse eventKey=\"0\">\n                            <Card.Body>\n                                <Row className=\"justify-content-md-center\">\n                                    <Col>\n                                        <ListGroup>\n                                            <ListGroup.Item\n                                                style={{ fontSize: \"1.3rem\" }}\n                                            >\n                                                카테고리: {product.category}\n                                            </ListGroup.Item>\n                                            <ListGroup.Item\n                                                style={{ fontSize: \"1.3rem\" }}\n                                            >\n                                                상품명: {product.name}\n                                            </ListGroup.Item>\n                                            <ListGroup.Item\n                                                style={{ fontSize: \"1.3rem\" }}\n                                            >\n                                                가격: {setMoney(product.price)}{\" \"}\n                                                원\n                                            </ListGroup.Item>\n                                            <ListGroup.Item\n                                                style={{ fontSize: \"1.3rem\" }}\n                                            >\n                                                수량: {product.quantity}\n                                            </ListGroup.Item>\n                                            <ListGroup.Item\n                                                style={{ fontSize: \"1.3rem\" }}\n                                            >\n                                                설명: {product.description}\n                                            </ListGroup.Item>\n                                            <ListGroup.Item\n                                                style={{ fontSize: \"1.3rem\" }}\n                                            >\n                                                등록일:{\" \"}\n                                                {setDate(product.created_at)}\n                                            </ListGroup.Item>\n\n                                            <ListGroup.Item>\n                                                {images}\n                                            </ListGroup.Item>\n                                        </ListGroup>\n                                        <br />\n                                    </Col>\n                                </Row>\n                            </Card.Body>\n                        </Accordion.Collapse>\n                    </Card>\n                </Accordion>\n\n                <ListGroup style={{ marginTop: 20 }}>\n                    {orders.length == 0 ? (\n                        <div>\n                            <br />\n                            <p style={{ fontSize: \"1.7rem\" }}>\n                                아직 주문한 사람이 없네요...\n                            </p>\n                            <img\n                                style={{ maxWidth: \"50%\", height: \"auto\" }}\n                                src={EmptyBox}\n                            ></img>\n                        </div>\n                    ) : (\n                        <div>\n                            <br />\n                            <p\n                                className=\"primaryColor\"\n                                style={{ fontSize: \"1.8rem\", margin: 20 }}\n                            >\n                                주문 요청이 들어왔어요!\n                            </p>\n                            {orders}\n                        </div>\n                    )}\n                </ListGroup>\n            </Container>\n        </div>\n    );\n}\n\nexport default MySalesDetail;\n"]},"metadata":{},"sourceType":"module"}