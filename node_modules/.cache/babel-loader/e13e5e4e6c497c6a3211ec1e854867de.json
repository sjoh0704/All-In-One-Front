{"ast":null,"code":"import _defineProperty from\"/home/seungju_oh@tmax.co.kr/seung/all-in-one/All-In-One-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"/home/seungju_oh@tmax.co.kr/seung/all-in-one/All-In-One-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/home/seungju_oh@tmax.co.kr/seung/all-in-one/All-In-One-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState}from\"react\";import{useSelector,useDispatch}from\"react-redux\";import axios from\"axios\";import{Form,Container,Button,Row,Col}from\"react-bootstrap\";import ImageUploading from\"react-images-uploading\";import{CategoryDirection}from\"./CategoryBanner\";import AreaButton from\"./AreaButton\";import Modal from\"./Modal\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function ProductRegister(_ref){var history=_ref.history;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),modalOpen=_useState2[0],setModalOpen=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),modalContents=_useState4[0],setModalContents=_useState4[1];var closeModal=function closeModal(){setModalOpen(false);};var _useState5=useState(\"지역을 선택해 주세요\"),_useState6=_slicedToArray(_useState5,2),area=_useState6[0],setArea=_useState6[1];var _useSelector=useSelector(function(state){return{isLoggedIn:state.user.isLoggedIn,userData:state.user.payload};}),isLoggedIn=_useSelector.isLoggedIn,userData=_useSelector.userData;var _useSelector2=useSelector(function(state){return{kind:state.category.payload};}),kind=_useSelector2.kind;var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),images=_useState8[0],setImages=_useState8[1];var maxNumber=4;var onChangeImage=function onChangeImage(imageList,addUpdateIndex){console.log(imageList,addUpdateIndex);setImages(imageList);};var onError=function onError(errors,files){if(errors.maxNumber){alert(\"\\uC774\\uBBF8\\uC9C0\\uB294 \".concat(maxNumber,\"\\uAC1C\\uAE4C\\uC9C0\\uB9CC \\uCCA8\\uBD80\\uD560 \\uC218 \\uC788\\uC2B5\\uB2C8\\uB2E4\"));}};var displayCategory=kind.map(function(k,index){return/*#__PURE__*/_jsx(\"option\",{children:k.kind});});var _useState9=useState({name:\"\",category:kind[0].kind,price:null,quantity:1,description:\"\"}),_useState10=_slicedToArray(_useState9,2),product=_useState10[0],setProduct=_useState10[1];var name=product.name,category=product.category,price=product.price,quantity=product.quantity,description=product.description;var onChangeHandler=function onChangeHandler(e){var _e$target=e.target,name=_e$target.name,value=_e$target.value;setProduct(_objectSpread(_objectSpread({},product),{},_defineProperty({},name,value)));};var onChangeArea=function onChangeArea(e){var _e$target2=e.target,name=_e$target2.name,value=_e$target2.value;setArea(value);};var onClickHandler=function onClickHandler(e){var category_id=kind[kind.findIndex(function(k){return k.kind===category;})].pk;var image_list=images.map(function(img,index){return img.data_url;});e.preventDefault();if(!(name&&category_id&&price&&quantity&&description&&image_list.length)){setModalOpen(true);setModalContents(\"모든 항목을 입력해 주세요\");return;}if(area==undefined||area==null||area==\"지역을 선택해 주세요\"){setModalOpen(true);setModalContents(\"거래 지역을 선택해 주세요\");return;}var body=_objectSpread({seller_id:userData.user_id,name:name,category_id:category_id,price:price,quantity:quantity,area:area,description:description},image_list);axios.post(\"/apis/v1/product\",body).then(function(response){history.replace(\"/\");}).catch(function(e){setModalOpen(true);setModalContents(\"상품 등록에 실패하였습니다. 관리자에게 문의하세요.\");});};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Modal,{open:modalOpen,close:closeModal,children:modalContents}),/*#__PURE__*/_jsxs(Container,{children:[/*#__PURE__*/_jsx(CategoryDirection,{tag1:\"판매하기\"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"div\",{style:{fontSize:\"1.3rem\"},children:/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsx(Col,{lg:{span:11,offset:2},sm:{span:12,offset:0},xs:{span:12},children:/*#__PURE__*/_jsxs(Form,{children:[/*#__PURE__*/_jsxs(Form.Group,{controlId:\"exampleForm.ControlSelect1\",as:Row,children:[/*#__PURE__*/_jsx(Form.Label,{column:true,sm:\"2\",lg:\"1\",xs:\"4\",children:\"\\uCE74\\uD14C\\uACE0\\uB9AC\"}),/*#__PURE__*/_jsx(Col,{sm:\"2\",xs:\"8\",children:/*#__PURE__*/_jsx(Form.Control,{as:\"select\",name:\"category\",onChange:onChangeHandler,value:category,children:displayCategory})})]}),/*#__PURE__*/_jsxs(Form.Group,{controlId:\"exampleForm.ControlInput1\",as:Row,children:[/*#__PURE__*/_jsx(Form.Label,{column:true,sm:\"2\",lg:\"1\",xs:\"4\",children:\"\\uC0C1\\uD488\\uBA85\"}),/*#__PURE__*/_jsx(Col,{sm:\"10\",lg:\"8\",xs:\"8\",children:/*#__PURE__*/_jsx(Form.Control,{name:\"name\",value:name,onChange:onChangeHandler,placeholder:\"\\uC0C1\\uD488\\uBA85\\uC744 \\uC801\\uC5B4\\uC8FC\\uC138\\uC694\"})})]}),/*#__PURE__*/_jsxs(Form.Group,{controlId:\"exampleForm.ControlInput1\",as:Row,children:[/*#__PURE__*/_jsx(Form.Label,{column:true,sm:\"2\",lg:\"1\",xs:\"4\",children:\"\\uAC00\\uACA9\"}),/*#__PURE__*/_jsx(Col,{sm:\"4\",lg:\"2\",xs:\"7\",children:/*#__PURE__*/_jsx(Form.Control,{name:\"price\",value:price,onChange:onChangeHandler,placeholder:\"\\uAC00\\uACA9\\uC744 \\uC801\\uC5B4\\uC8FC\\uC138\\uC694\"})}),/*#__PURE__*/_jsx(Col,{xs:\"1\",children:/*#__PURE__*/_jsx(\"p\",{children:\"\\u20A9\"})})]}),/*#__PURE__*/_jsxs(Form.Group,{controlId:\"exampleForm.ControlInput1\",as:Row,children:[/*#__PURE__*/_jsx(Form.Label,{column:true,sm:\"2\",lg:\"1\",xs:\"4\",children:\"\\uC218\\uB7C9\"}),/*#__PURE__*/_jsx(Col,{sm:\"2\",lg:\"1\",xs:\"8\",children:/*#__PURE__*/_jsx(Form.Control,{name:\"quantity\",value:quantity,onChange:onChangeHandler,placeholder:\"\\uC218\\uB7C9\\uC744 \\uC801\\uC5B4\\uC8FC\\uC138\\uC694\"})})]}),/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{sm:\"2\",lg:\"1\",xs:\"4\",style:{paddingTop:20},children:\"\\uAC70\\uB798 \\uC9C0\\uC5ED\"}),/*#__PURE__*/_jsx(Col,{sm:\"6\",lg:\"6\",xs:\"6\",style:{paddingTop:8},children:/*#__PURE__*/_jsx(AreaButton,{onChange:onChangeArea,area:area})})]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(Form.Group,{controlId:\"exampleForm.ControlTextarea1\",as:Row,children:[/*#__PURE__*/_jsx(Form.Label,{column:true,sm:\"2\",lg:\"1\",children:\"\\uC0C1\\uD488\\uC124\\uBA85\"}),/*#__PURE__*/_jsx(Col,{sm:\"10\",lg:\"8\",children:/*#__PURE__*/_jsx(Form.Control,{as:\"textarea\",rows:5,onChange:onChangeHandler,name:\"description\",placeholder:\"\\uC0C1\\uD488 \\uC124\\uBA85\\uC744 \\uC801\\uC5B4\\uC8FC\\uC138\\uC694\",value:description})})]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(Form.Group,{controlId:\"exampleForm.ControlTextarea1\",as:Row,children:[/*#__PURE__*/_jsx(Form.Label,{children:\"\\uC0C1\\uD488 \\uC774\\uBBF8\\uC9C0 \\uB4F1\\uB85D\"}),/*#__PURE__*/_jsx(ImageUploading,{multiple:true,value:images,onChange:onChangeImage,maxNumber:maxNumber,dataURLKey:\"data_url\",onError:onError// 추가\n,children:function children(_ref2){var imageList=_ref2.imageList,onImageUpload=_ref2.onImageUpload,onImageUpdate=_ref2.onImageUpdate,onImageRemove=_ref2.onImageRemove,isDragging=_ref2.isDragging,dragProps=_ref2.dragProps;return/*#__PURE__*/ (// write your building UI\n_jsxs(\"div\",{className:\"upload__image-wrapper\",children:[/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(Button,_objectSpread(_objectSpread({variant:\"outline-light\",style:{background:\"#e85255\",fontSize:\"1.3rem\"},onClick:function onClick(e){e.preventDefault();onImageUpload();}},dragProps),{},{children:\"\\uC0AC\\uC9C4 \\uCD94\\uAC00\"})),/*#__PURE__*/_jsx(\"br\",{}),\"\\xA0\",imageList.map(function(image,index){return/*#__PURE__*/_jsxs(\"div\",{className:\"image-item\",children:[/*#__PURE__*/_jsx(\"img\",{src:image[\"data_url\"],alt:\"\",width:\"700\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"image-item__btn-wrapper\",children:[/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(Button,{variant:\"outline-light\",style:{background:\"#e85255\",fontSize:\"1.3rem\"},onClick:function onClick(e){e.preventDefault();onImageUpdate(index);},children:\"\\uC218\\uC815\"}),\" \",/*#__PURE__*/_jsx(Button,{variant:\"outline-light\",style:{background:\"#e85255\",fontSize:\"1.3rem\"},onClick:function onClick(e){e.preventDefault();onImageRemove(index);},children:\"\\uC0AD\\uC81C\"})]}),/*#__PURE__*/_jsx(\"br\",{})]},index);})]}));}}),/*#__PURE__*/_jsxs(Col,{children:[/*#__PURE__*/_jsx(\"p\",{children:\"\\uC774\\uBBF8\\uC9C0\\uB294 \\uCD5C\\uB300 \".concat(maxNumber,\"\\uAC1C\\uAE4C\\uC9C0\\uB9CC \\uCCA8\\uBD80\\uD560 \\uC218 \\uC788\\uC2B5\\uB2C8\\uB2E4\")}),/*#__PURE__*/_jsx(\"br\",{})]})]}),/*#__PURE__*/_jsx(Button,{type:\"submit\",variant:\"outline-light\",style:{background:\"#e85255\",fontSize:\"1.3rem\"},onClick:onClickHandler,children:\"\\uC0C1\\uD488 \\uB4F1\\uB85D\"})]})})})})]})]});}export default ProductRegister;","map":{"version":3,"sources":["/home/seungju_oh@tmax.co.kr/seung/all-in-one/All-In-One-front/src/components/ProductRegister.js"],"names":["React","useState","useSelector","useDispatch","axios","Form","Container","Button","Row","Col","ImageUploading","CategoryDirection","AreaButton","Modal","ProductRegister","history","modalOpen","setModalOpen","modalContents","setModalContents","closeModal","area","setArea","state","isLoggedIn","user","userData","payload","kind","category","images","setImages","maxNumber","onChangeImage","imageList","addUpdateIndex","console","log","onError","errors","files","alert","displayCategory","map","k","index","name","price","quantity","description","product","setProduct","onChangeHandler","e","target","value","onChangeArea","onClickHandler","category_id","findIndex","pk","image_list","img","data_url","preventDefault","length","undefined","body","seller_id","user_id","post","then","response","replace","catch","fontSize","span","offset","paddingTop","onImageUpload","onImageUpdate","onImageRemove","isDragging","dragProps","background","image"],"mappings":"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","sourcesContent":["import React, { useState } from \"react\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport axios from \"axios\";\nimport { Form, Container, Button, Row, Col } from \"react-bootstrap\";\nimport ImageUploading from \"react-images-uploading\";\nimport { CategoryDirection } from \"./CategoryBanner\";\nimport AreaButton from \"./AreaButton\";\nimport Modal from \"./Modal\";\n\nfunction ProductRegister({ history }) {\n    const [modalOpen, setModalOpen] = useState(false);\n\n    const [modalContents, setModalContents] = useState(\"\");\n    const closeModal = () => {\n        setModalOpen(false);\n    };\n    const [area, setArea] = useState(\"지역을 선택해 주세요\");\n    const { isLoggedIn, userData } = useSelector((state) => ({\n        isLoggedIn: state.user.isLoggedIn,\n        userData: state.user.payload,\n    }));\n    const { kind } = useSelector((state) => ({\n        kind: state.category.payload,\n    }));\n    const [images, setImages] = useState([]);\n    const maxNumber = 4;\n\n    const onChangeImage = (imageList, addUpdateIndex) => {\n        console.log(imageList, addUpdateIndex);\n        setImages(imageList);\n    };\n\n    const onError = (errors, files) => {\n        if (errors.maxNumber) {\n            alert(`이미지는 ${maxNumber}개까지만 첨부할 수 있습니다`);\n        }\n    };\n\n    const displayCategory = kind.map((k, index) => {\n        return <option>{k.kind}</option>;\n    });\n\n    const [product, setProduct] = useState({\n        name: \"\",\n        category: kind[0].kind,\n        price: null,\n        quantity: 1,\n        description: \"\",\n    });\n\n    const { name, category, price, quantity, description } = product;\n\n    const onChangeHandler = (e) => {\n        const { name, value } = e.target;\n        setProduct({\n            ...product,\n            [name]: value,\n        });\n    };\n\n    const onChangeArea = (e) => {\n        const { name, value } = e.target;\n        setArea(value);\n    };\n\n    const onClickHandler = (e) => {\n        let category_id = kind[kind.findIndex((k) => k.kind === category)].pk;\n        let image_list = images.map((img, index) => img.data_url);\n        e.preventDefault();\n\n        if (\n            !(\n                name &&\n                category_id &&\n                price &&\n                quantity &&\n                description &&\n                image_list.length\n            )\n        ) {\n            setModalOpen(true);\n            setModalContents(\"모든 항목을 입력해 주세요\");\n            return;\n        }\n        if (\n            area == undefined ||\n            area == null ||\n            area == \"지역을 선택해 주세요\"\n        ) {\n            setModalOpen(true);\n            setModalContents(\"거래 지역을 선택해 주세요\");\n            return;\n        }\n        const body = {\n            seller_id: userData.user_id,\n            name: name,\n            category_id: category_id,\n            price: price,\n            quantity: quantity,\n            area: area,\n            description: description,\n            ...image_list, // 용량이 크면 안넘어가\n        };\n\n        axios\n            .post(\"/apis/v1/product\", body)\n            .then((response) => {\n                history.replace(\"/\");\n            })\n            .catch((e) => {\n                setModalOpen(true);\n                setModalContents(\n                    \"상품 등록에 실패하였습니다. 관리자에게 문의하세요.\"\n                );\n            });\n    };\n\n    return (\n        <div>\n            <Modal open={modalOpen} close={closeModal}>\n                {modalContents}\n            </Modal>\n\n            <Container>\n                <CategoryDirection tag1={\"판매하기\"}></CategoryDirection>\n                <br />\n                <div style={{ fontSize: \"1.3rem\" }}>\n                    <Row>\n                        <Col\n                            lg={{ span: 11, offset: 2 }}\n                            sm={{ span: 12, offset: 0 }}\n                            xs={{ span: 12 }}\n                        >\n                            <Form>\n                                <Form.Group\n                                    controlId=\"exampleForm.ControlSelect1\"\n                                    as={Row}\n                                >\n                                    <Form.Label column sm=\"2\" lg=\"1\" xs=\"4\">\n                                        카테고리\n                                    </Form.Label>\n                                    <Col sm=\"2\" xs=\"8\">\n                                        <Form.Control\n                                            as=\"select\"\n                                            name=\"category\"\n                                            onChange={onChangeHandler}\n                                            value={category}\n                                        >\n                                            {displayCategory}\n                                        </Form.Control>\n                                    </Col>\n                                </Form.Group>\n\n                                <Form.Group\n                                    controlId=\"exampleForm.ControlInput1\"\n                                    as={Row}\n                                >\n                                    <Form.Label column sm=\"2\" lg=\"1\" xs=\"4\">\n                                        상품명\n                                    </Form.Label>\n                                    <Col sm=\"10\" lg=\"8\" xs=\"8\">\n                                        <Form.Control\n                                            name=\"name\"\n                                            value={name}\n                                            onChange={onChangeHandler}\n                                            placeholder=\"상품명을 적어주세요\"\n                                        />\n                                    </Col>\n                                </Form.Group>\n\n                                <Form.Group\n                                    controlId=\"exampleForm.ControlInput1\"\n                                    as={Row}\n                                >\n                                    <Form.Label column sm=\"2\" lg=\"1\" xs=\"4\">\n                                        가격\n                                    </Form.Label>\n                                    <Col sm=\"4\" lg=\"2\" xs=\"7\">\n                                        <Form.Control\n                                            name=\"price\"\n                                            value={price}\n                                            onChange={onChangeHandler}\n                                            placeholder=\"가격을 적어주세요\"\n                                        />\n                                    </Col>\n                                    <Col xs=\"1\">\n                                        <p>₩</p>\n                                    </Col>\n                                </Form.Group>\n\n                                <Form.Group\n                                    controlId=\"exampleForm.ControlInput1\"\n                                    as={Row}\n                                >\n                                    <Form.Label column sm=\"2\" lg=\"1\" xs=\"4\">\n                                        수량\n                                    </Form.Label>\n                                    <Col sm=\"2\" lg=\"1\" xs=\"8\">\n                                        <Form.Control\n                                            name=\"quantity\"\n                                            value={quantity}\n                                            onChange={onChangeHandler}\n                                            placeholder=\"수량을 적어주세요\"\n                                        />\n                                    </Col>\n                                </Form.Group>\n\n                                <Row>\n                                    <Col\n                                        sm=\"2\"\n                                        lg=\"1\"\n                                        xs=\"4\"\n                                        style={{ paddingTop: 20 }}\n                                    >\n                                        거래 지역\n                                    </Col>\n                                    <Col\n                                        sm=\"6\"\n                                        lg=\"6\"\n                                        xs=\"6\"\n                                        style={{ paddingTop: 8 }}\n                                    >\n                                        <AreaButton\n                                            onChange={onChangeArea}\n                                            area={area}\n                                        />\n                                    </Col>\n                                </Row>\n                                <br />\n                                <Form.Group\n                                    controlId=\"exampleForm.ControlTextarea1\"\n                                    as={Row}\n                                >\n                                    <Form.Label column sm=\"2\" lg=\"1\">\n                                        상품설명\n                                    </Form.Label>\n                                    <Col sm=\"10\" lg=\"8\">\n                                        <Form.Control\n                                            as=\"textarea\"\n                                            rows={5}\n                                            onChange={onChangeHandler}\n                                            name=\"description\"\n                                            placeholder=\"상품 설명을 적어주세요\"\n                                            value={description}\n                                        />\n                                    </Col>\n                                </Form.Group>\n                                <br />\n                                <Form.Group\n                                    controlId=\"exampleForm.ControlTextarea1\"\n                                    as={Row}\n                                >\n                                    <Form.Label>상품 이미지 등록</Form.Label>\n                                    {/* <Button onClick={onClickGetImage}>이미지 가져오기 </Button> */}\n\n                                    <ImageUploading\n                                        multiple\n                                        value={images}\n                                        onChange={onChangeImage}\n                                        maxNumber={maxNumber}\n                                        dataURLKey=\"data_url\"\n                                        onError={onError} // 추가\n                                    >\n                                        {({\n                                            imageList,\n                                            onImageUpload,\n                                            onImageUpdate,\n                                            onImageRemove,\n                                            isDragging,\n                                            dragProps,\n                                        }) => (\n                                            // write your building UI\n\n                                            <div className=\"upload__image-wrapper\">\n                                                <br />\n                                                <Button\n                                                    variant=\"outline-light\"\n                                                    style={{\n                                                        background: \"#e85255\",\n                                                        fontSize: \"1.3rem\",\n                                                    }}\n                                                    onClick={(e) => {\n                                                        e.preventDefault();\n                                                        onImageUpload();\n                                                    }}\n                                                    {...dragProps}\n                                                >\n                                                    사진 추가\n                                                </Button>\n                                                <br />\n                                                &nbsp;\n                                                {imageList.map(\n                                                    (image, index) => (\n                                                        <div\n                                                            key={index}\n                                                            className=\"image-item\"\n                                                        >\n                                                            <img\n                                                                src={\n                                                                    image[\n                                                                        \"data_url\"\n                                                                    ]\n                                                                }\n                                                                alt=\"\"\n                                                                width=\"700\"\n                                                            />\n                                                            <div className=\"image-item__btn-wrapper\">\n                                                                <br />\n                                                                <Button\n                                                                    variant=\"outline-light\"\n                                                                    style={{\n                                                                        background:\n                                                                            \"#e85255\",\n                                                                        fontSize:\n                                                                            \"1.3rem\",\n                                                                    }}\n                                                                    onClick={(\n                                                                        e\n                                                                    ) => {\n                                                                        e.preventDefault();\n                                                                        onImageUpdate(\n                                                                            index\n                                                                        );\n                                                                    }}\n                                                                >\n                                                                    수정\n                                                                </Button>{\" \"}\n                                                                <Button\n                                                                    variant=\"outline-light\"\n                                                                    style={{\n                                                                        background:\n                                                                            \"#e85255\",\n                                                                        fontSize:\n                                                                            \"1.3rem\",\n                                                                    }}\n                                                                    onClick={(\n                                                                        e\n                                                                    ) => {\n                                                                        e.preventDefault();\n                                                                        onImageRemove(\n                                                                            index\n                                                                        );\n                                                                    }}\n                                                                >\n                                                                    삭제\n                                                                </Button>\n                                                            </div>\n                                                            <br />\n                                                        </div>\n                                                    )\n                                                )}\n                                            </div>\n                                        )}\n                                    </ImageUploading>\n                                    <Col>\n                                        <p>\n                                            {`이미지는 최대 ${maxNumber}개까지만 첨부할 수 있습니다`}\n                                        </p>\n                                        <br />\n                                    </Col>\n                                </Form.Group>\n                                <Button\n                                    type=\"submit\"\n                                    variant=\"outline-light\"\n                                    style={{\n                                        background: \"#e85255\",\n                                        fontSize: \"1.3rem\",\n                                    }}\n                                    onClick={onClickHandler}\n                                >\n                                    상품 등록\n                                </Button>\n                            </Form>\n                        </Col>\n                    </Row>\n                </div>\n            </Container>\n        </div>\n    );\n}\n\nexport default ProductRegister;\n"]},"metadata":{},"sourceType":"module"}